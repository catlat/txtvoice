方案 A（长期保持 Edge 调试模式，计划任务只跑导出）
思路：让 Edge 一直以 --remote-debugging-port=9222 运行，计划任务每5分钟只执行 Python 脚本刷新 Redis 中的 Cookie。
启动 Edge（一次性/随登录自动）：
放到“启动”文件夹：按 Win+R 输入 shell:startup，为以下目标创建快捷方式：
或用计划任务在“登录时”触发同样的命令（建议单独建一个“EdgeDebug9222”任务）。
建计划任务（每5分钟）仅执行 Python：
GUI（任务计划程序）要点：
触发器：按计划，每5分钟重复，持续无限期。
操作：启动程序
程序/脚本：python
添加参数：D:\File\text-voice\cmd\export_edge_cookie.py youtube（或 bilibili）
起始于：D:\File\text-voice\（或留空也行，因已用绝对路径）
设置：勾选“允许按需运行任务”；“若任务已在运行，则不启动新实例”。
条件：可取消“仅当计算机使用交流电源时才启动”。
命令行等价（每5分钟跑 YouTube）：
（B站再建一个，把 youtube 换成 bilibili。）
注意：
任务账户请选择你当前登录账号，并勾“仅当用户登录时运行”，避免桌面会话/配置目录权限问题。
如果你把 Edge 专用目录设为 %LOCALAPPDATA%\EdgeCookieExport，首次手工打开后在该窗口登录一次即可，后续任务只读 Cookie。
方案 C（一键脚本封装检测+启动 Edge，再导出）
思路：创建一个 PowerShell 脚本（例如 D:\File\text-voice\export-cookies.ps1），内部先检测 9222 端口，不在则启动带调试端口的 Edge，然后执行 Python 导出；计划任务每5分钟只调用这一个脚本。
计划任务（每5分钟）：
GUI（推荐）：
程序/脚本：powershell.exe
添加参数：-NoProfile -ExecutionPolicy Bypass -File D:\File\text-voice\export-cookies.ps1 -Platform youtube
起始于：D:\File\text-voice\
触发器/设置同上（每5分钟、不启动新实例、仅当用户登录时运行）。
命令行等价：
（B站再建一个 -Platform bilibili 的任务。）
注意：
这种方式不再需要你手工 taskkill 或手动启动 Edge；脚本会自动“有则用、无则启”，鲁棒性更好。
同样建议“仅当用户登录时运行”，并使用你自己的账户上下文。
通用细节与建议
Python 路径：若系统 python 未在 PATH，可改成完整路径（如 C:\Python312\python.exe），或使用 py -3。
重叠保护：任务“设置”里选择“如果任务已在运行，则不启动新实例”，避免并发冲突。
运行超时：可在“设置”里设置“停止任务如果运行超过 2 分钟”，避免长时间挂起。
首次登录：无论 A 或 C，第一次用专用目录启动的 Edge 窗口里需要你登陆一次对应平台，使 Cookie 持久化到该目录。
频率：5 分钟足够应对短期变动；如平台有更严格过期策略，可把触发频率调整为 10-15 分钟以减少无谓刷新。